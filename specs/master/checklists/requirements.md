# 需求完整性检查清单

**目的**: 验证PRD和需求文档的质量、完整性和可测试性  
**创建日期**: 2025-11-13  
**检查级别**: 标准级（PR审查）  
**适用文档**: PRD（网络小说智能问答系统PRD-最终版.md）

---

## 需求完整性

- [ ] CHK001 - 是否为所有7个用户故事定义了明确的验收标准？ [完整性，PRD §2]
- [ ] CHK002 - 是否明确定义了MVP版本和优化版本的功能范围差异？ [完整性，PRD §1.3]
- [ ] CHK003 - 对于千万字级小说处理，是否定义了内存峰值、存储空间等资源限制？ [完整性，PRD §1.6]
- [ ] CHK004 - 是否为所有支持的文件格式（TXT、EPUB）定义了解析失败的处理要求？ [缺口，PRD §2.1.1]
- [ ] CHK005 - 是否定义了章节识别失败时的降级策略或人工干预机制？ [缺口，PRD §2.1.1]
- [ ] CHK006 - 对于"准确性 > 成本 > 效率"的设计原则，是否在具体功能需求中有明确的权衡指导？ [清晰度，PRD §1]
- [ ] CHK007 - 是否定义了系统同时处理多本小说的并发限制？ [缺口]
- [ ] CHK008 - 对于索引构建失败（如API限流、网络中断），是否定义了断点续传的具体恢复策略？ [完整性，PRD §2.1.1]

## 需求清晰度

- [ ] CHK009 - "事实查询准确率"的计算方法是否明确定义？如何判定一个答案是否准确？ [可测量性，PRD §1.3]
- [ ] CHK010 - "叙述诡计识别率"的评估标准是否明确？哪些类型的诡计算作"中级"？ [清晰度，PRD §1.3]
- [ ] CHK011 - "简单查询"和"复杂查询"的区分标准是否明确定义？ [清晰度，PRD §1.3]
- [ ] CHK012 - "块大小500-600字符"是否明确指定了字符计数方式（是否包含空格、标点）？ [清晰度，PRD §2.1.1]
- [ ] CHK013 - "批处理大小100个文本块/批"是否与智谱AI API的实际限制一致？ [准确性，PRD §2.1.1]
- [ ] CHK014 - "章节重要性评分"的计算公式是否明确定义了各维度的权重？ [清晰度，PRD §2.2.2]
- [ ] CHK015 - "流式响应5个阶段"中每个阶段的开始/结束条件是否明确？ [清晰度，PRD §2.3.1]
- [ ] CHK016 - "矛盾检测"的判定阈值是否量化（如语义相似度<X视为矛盾）？ [可测量性，PRD §2.3.4]

## 需求一致性

- [ ] CHK017 - 数据模型中定义的字段是否与API响应结构一致？ [一致性，对比data-model.md和contracts/]
- [ ] CHK018 - PRD中的成功指标是否与plan.md中的性能要求对齐？ [一致性，PRD §1.3 vs Plan §Goals]
- [ ] CHK019 - PRD中的技术栈（如ChromaDB 0.4+）是否与plan.md和research.md保持一致？ [一致性]
- [ ] CHK020 - 所有用户故事的Token统计需求是否与PRD §2.7的统计维度一致？ [一致性]
- [ ] CHK021 - PRD中的WebSocket消息类型是否与contracts/openapi.yaml定义一致？ [一致性]

## 场景覆盖

- [ ] CHK022 - 是否定义了零状态场景的需求（如用户首次访问、无小说上传）？ [缺口]
- [ ] CHK023 - 是否定义了小说列表为空时的UI展示需求？ [缺口]
- [ ] CHK024 - 是否定义了索引进度为0%或100%时的特殊处理需求？ [覆盖，PRD §2.1.2]
- [ ] CHK025 - 是否定义了用户在索引过程中关闭浏览器后重新打开的恢复需求？ [缺口]
- [ ] CHK026 - 是否定义了查询历史为空时的展示和交互需求？ [缺口]
- [ ] CHK027 - 是否定义了知识图谱未构建时（如仅完成向量索引）的降级查询策略？ [缺口]
- [ ] CHK028 - 是否定义了多用户并发上传同一小说的冲突处理？ [缺口]

## 边缘情况与异常流

- [ ] CHK029 - 是否定义了小说文件损坏（如TXT编码错误、EPUB结构不完整）的错误提示需求？ [缺口]
- [ ] CHK030 - 是否定义了智谱AI API Key无效或余额不足时的错误处理和用户提示？ [缺口]
- [ ] CHK031 - 是否定义了网络断开时WebSocket自动重连的最大尝试次数和提示？ [缺口]
- [ ] CHK032 - 是否定义了ChromaDB存储空间不足时的错误处理？ [缺口]
- [ ] CHK033 - 是否定义了HanLP模型加载失败时的降级方案（如跳过实体提取）？ [缺口]
- [ ] CHK034 - 是否定义了章节数超过预期（如>10000章）时的性能限制或警告？ [缺口]
- [ ] CHK035 - 是否定义了用户输入超长查询（如>1000字）时的处理策略？ [缺口]
- [ ] CHK036 - 是否定义了GLM-4 API返回错误或超时时的重试策略和用户提示？ [缺口]

## 非功能需求

- [ ] CHK037 - 是否为所有交互元素定义了键盘导航的可访问性需求？ [缺口，符合WCAG 2.1 AA]
- [ ] CHK038 - 是否定义了屏幕阅读器支持的ARIA标签需求？ [缺口，Plan §Design System Compliance]
- [ ] CHK039 - 是否定义了暗黑模式支持的需求和颜色对比度标准？ [缺口]
- [ ] CHK040 - 是否定义了移动端响应式布局的断点要求？ [缺口，Plan §Scope提到响应式]
- [ ] CHK041 - "前端首屏加载 < 1.5秒"是否明确了测量环境（如网络速度、设备配置）？ [可测量性，Plan §Performance]
- [ ] CHK042 - 是否定义了日志记录的详细程度（如DEBUG/INFO/ERROR级别的具体内容）？ [缺口]
- [ ] CHK043 - 是否定义了敏感数据（如API Key）的加密存储和传输需求？ [缺口]
- [ ] CHK044 - 是否定义了SQLite数据库备份的频率和恢复策略？ [缺口，Data-model提到备份]

## 依赖与假设

- [ ] CHK045 - 是否验证了智谱AI Embedding-3模型的向量维度确实为1024维？ [假设验证，PRD §2.1.1]
- [ ] CHK046 - 是否验证了智谱AI批处理限制为100个文本块/批？ [假设验证，PRD §2.1.1]
- [ ] CHK047 - 是否明确了HanLP 2.1+的具体模型版本和下载源？ [依赖明确性，PRD §1.6]
- [ ] CHK048 - 是否明确了ChromaDB 0.4+与Python 3.10+的兼容性？ [依赖验证]
- [ ] CHK049 - 是否定义了当NetworkX图谱持久化文件损坏时的重建策略？ [依赖风险]
- [ ] CHK050 - "用户拥有小说文本合法使用权"的假设是否在产品中有明确的免责声明需求？ [假设显化，PRD §1.6]

## 可追溯性

- [ ] CHK051 - 是否为每个功能需求建立了唯一的ID标识符（如FR-001）？ [追溯性，PRD §2缺少ID]
- [ ] CHK052 - 是否为每个非功能需求建立了唯一的ID标识符（如NFR-001）？ [追溯性]
- [ ] CHK053 - 是否建立了用户故事到具体功能需求的映射关系？ [追溯性，PRD §2缺少明确映射]
- [ ] CHK054 - 是否建立了成功指标到验证方法的追溯关系？ [追溯性，PRD §1.3]

## 模糊性与冲突

- [ ] CHK055 - "相关文本块"的选择标准是否明确（Top-K值、相似度阈值）？ [模糊性，PRD §2.3.1]
- [ ] CHK056 - "Rerank"算法的具体实现方式是否在需求中明确？ [模糊性，PRD §2.3.1]
- [ ] CHK057 - "时序属性标注（早期/中期/后期）"的章节划分标准是否明确？ [模糊性，PRD §2.2.2]
- [ ] CHK058 - PRD中提到的"Self-RAG验证阶段"与流式响应的5个阶段关系是否明确？ [模糊性，PRD §2.3.1]
- [ ] CHK059 - "成本控制 < ¥0.5/查询"是否与"准确性优先"原则存在潜在冲突？ [潜在冲突，PRD §1]
- [ ] CHK060 - "块重叠100-150字符"的具体值选择是否有明确的决策依据？ [决策追溯，PRD §2.1.1]

---

**检查清单统计**: 60项  
**强制检查项**: CHK001-CHK020（需求基础质量）  
**建议检查项**: CHK021-CHK060（深度质量提升）

**使用说明**:
- 在PR审查时，重点检查"强制检查项"
- 发现问题时，标注具体的PRD章节号和问题类型（如[缺口]、[模糊性]）
- 对于标记为[缺口]的项，评估是否需要补充需求或明确排除在MVP范围外

